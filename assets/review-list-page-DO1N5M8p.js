import{l as Q,a9 as U,n as q,r as s,a_ as H,a$ as J,ai as K,aj as V,ak as W,U as o,j as t,$ as D,B as y,w as X,z as Z}from"./index-CK2H4E3S.js";import{D as N,R as ee,a as te}from"./delete-modal-CL-ZcFWt.js";import{C as se}from"./chevron-left-j8NZdg1J.js";import"./dialog-B55C9sa1.js";const oe=()=>{const x=Q(),{id:p}=U(),i=p?parseInt(p):0,{staticStart:M,complete:A}=q(),[v,$]=s.useState([]),[l,w]=s.useState(!1),[n,{data:d,isSuccess:h}]=H(),{data:c,isSuccess:g}=J({id:i.toString()}),[e,k]=s.useState(),[a,m]=s.useState(),[C,E]=s.useState(!1),[L,u]=s.useState(!1),[j,f]=s.useState(!1),[O,{isSuccess:R,isError:T}]=K(),[B,{isSuccess:S,isError:_}]=V(),[I,{isSuccess:b,isError:Y}]=W();s.useEffect(()=>{g&&k(c==null?void 0:c.data)},[g,c]),s.useEffect(()=>{l||(M(),w(!0)),n(i)},[i,n]),s.useEffect(()=>{var r;h&&($((r=d.data)!=null&&r.reviews?d.data.reviews:[]),w(!1),A())},[h,d]),s.useEffect(()=>{T&&o({title:"Error",description:`Error when added review for ${e==null?void 0:e.title} ðŸ˜°`})}),s.useEffect(()=>{R&&(n(i),E(!1),o({title:"Success",description:`Added review for ${e==null?void 0:e.title}`}))},[R]),s.useEffect(()=>{_&&o({title:"Error",description:`Error when edited review for ${e==null?void 0:e.title} ðŸ˜°`})}),s.useEffect(()=>{S&&(u(!1),n(i),o({title:"Success",description:`Edited review for ${e==null?void 0:e.title}`}))},[S]),s.useEffect(()=>{Y&&o({title:"Error",description:`Error when deleted review for ${e==null?void 0:e.title} ðŸ˜°`})}),s.useEffect(()=>{b&&(f(!1),n(e?e.id:0),o({title:"Success",description:`Deleted review for ${e==null?void 0:e.title}`}))},[b]);const z=r=>{O({movieId:i,content:r}),n(i||0)},F=(r,P)=>{B({reviewId:r,movieId:i,content:P})},G=r=>{I({reviewId:r,movieId:i})};return t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"relative h-[220px] bg-cover bg-center flex items-center bg-gray-900",...e?{style:{backgroundImage:`url(${D(e.backdrop_path||e.poster_path)})`}}:{},children:[t.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-80 backdrop-blur-md"}),t.jsxs("div",{className:"relative z-10 max-w-[1200px] container mx-auto p-2 h-full flex flex-col justify-between items-start",children:[t.jsxs(y,{variant:"outline",className:"flex border-none justify-start space-x-2 text-white hover:text-rose-600 bg-transparent hover:bg-transparent",onClick:()=>{x("/movie/"+(e==null?void 0:e.id))},children:[t.jsx(se,{}),t.jsx("span",{children:"Back"})]}),t.jsxs("div",{className:"flex items-center space-x-4",children:[e?t.jsx("img",{src:D(e.poster_path),alt:e.title,className:"w-24 h-32 rounded-md shadow-lg"}):t.jsx("div",{className:"w-24 h-32 bg-gray-900 rounded-md shadow-lg"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-lg font-semibold text-gray-300 hover:text-rose-600 hover:cursor-pointer",onClick:()=>x("/movie/"+(e==null?void 0:e.id)),children:e==null?void 0:e.title}),t.jsxs("p",{className:"text-sm text-gray-300",children:["Release: ",X(e==null?void 0:e.release_date).format("MMM DD YYYY")]}),t.jsx("h1",{className:"mt-3 text-3xl font-semibold",children:"User Reviews"})]})]})]})]}),t.jsxs("div",{className:"max-w-[1200px] container mx-auto p-4",children:[t.jsx(N,{triggerElement:t.jsx(y,{className:" rounded-full bg-rose-900 text-gray-300 hover:bg-rose-800 hover:text-white py-2 px-4",children:"Add New Review"}),open:C,onOpenChange:E,onSave:z}),t.jsx("div",{className:"px-8 py-6",children:l?t.jsx("div",{className:"flex justify-center items-center h-40",children:t.jsx(Z,{isOpening:l})}):v.length>0?t.jsx("ul",{className:"space-y-4",children:v.map(r=>t.jsx(ee,{review:r,onEdit:()=>{m(r),u(!0)},onDelete:()=>{m(r),f(!0)}},r.id))}):t.jsx("p",{className:"flex item-center text-gray-300",children:"There are no reviews that matched for this movie."})}),t.jsx(N,{open:L,onOpenChange:u,triggerElement:t.jsx(t.Fragment,{}),onSave:r=>{a&&F(a.id,r)},initialText:a==null?void 0:a.comment}),t.jsx(te,{isOpen:j,onClose:()=>f(!j),onDelete:()=>{a&&G(a.id)},content:"Are you sure you want to delete this review?"})]})]})};export{oe as default};
